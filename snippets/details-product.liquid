<section class="jss71">
  <div class="jss69">
    <div class="jss68"><img src="{{ 'icon_package.svg' | asset_url }}" alt="Ícone pacote" /></div>
    <div class="jss72">
      <div class="jss41 jss50 jss54">Troca ou devolução grátis</div>
      <div class="jss40 jss50 jss54 jss67">Fácil e sem burocracia</div>
    </div>
  </div>
  <div class="jss69">
    <div class="jss68"><img src="{{ 'icon_check.svg' | asset_url }}" alt="Ícone garantia" /></div>
    <div class="jss72">
      <div class="jss41 jss50 jss54">Garantia de um ano</div>
      <div class="jss40 jss50 jss54 jss67">Ative quando precisar</div>
    </div>
  </div>
  <div class="jss69">
    <div class="jss68"><img src="{{ 'icon_chat_bubble.svg' | asset_url }}" alt="Ícone balão de conversa" /></div>
    <div class="jss72">
      <div class="jss41 jss50 jss54">Suporte online</div>
      <div class="jss40 jss50 jss54 jss67"><a class="jss14 jss70" href="https://wa.me/{{ shop.phone }}">Fale com a Casa Segura ›</a></div>
    </div>
  </div>
</section>

<section class="jss77">
  <section class="Paper-root accordion-root jss79 Paper-elevation0">
    <div class="button-base-root accordion-summary-root jss81" role="button" id="button-accordion-0" onclick="toggleAccordion(0)">
      <div class="accordion-summary-content jss82">
        <img class="jss75" src="{{ 'icon_magnifying_glass.svg' | asset_url }}" alt="Ícone de uma lupa" />
        <div>
          <h3 class="jss41 jss46 jss54">Introdução</h3>
          <h4 class="jss40 jss49 jss54 jss73">Conheça {{ product.title }}</h4>
        </div>
      </div>
      <div class="button-base-root icon-button-root accordion-summary-expandIcon jss83 icon-button-edgeEnd" aria-disabled="false" aria-hidden="true">
        <span class="icon-button-label">
          <img class="jss74" src="{{ 'icon_plus_sign-gray.svg' | asset_url }}" />
        </span>
      </div>
    </div>

    <div class="accordion-content collapse-hidden" id="accordion-0">
      <div class="collapse-wrapper">
        <div class="collapse-wrapperInner">
          <div role="region">
            <div class="MuiAccordionDetails-root jss84">
              {% render 'intro-product', product: product %}
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="Paper-root accordion-root jss79 Paper-elevation0">
    <div class="button-base-root accordion-summary-root jss81" role="button" id="button-accordion-1" onclick="toggleAccordion(1)">
      <div class="accordion-summary-content jss82">
        <img class="jss75" src="{{ 'icon_camera.svg' | asset_url }}" alt="Ícone de uma lupa" />
        <div>
          <h3 class="jss41 jss46 jss54">Stories dos usuários</h3>
          <h4 class="jss40 jss49 jss54 jss73">Publicados no Instagram</h4>
        </div>
      </div>
      <div class="button-base-root icon-button-root accordion-summary-expandIcon jss83 icon-button-edgeEnd" aria-disabled="false" aria-hidden="true">
        <span class="icon-button-label">
          <img class="jss74" src="{{ 'icon_plus_sign-gray.svg' | asset_url }}" />
        </span>
      </div>
    </div>

    <div class="accordion-content collapse-hidden" id="accordion-1">
      <div class="collapse-wrapper">
        <div class="collapse-wrapperInner">
          <div role="region">
            <div class="accordion-details-root jss84">
              {% render 'details-product-stories', product: product %}
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="Paper-root accordion-root jss79 Paper-elevation0">
    <div class="button-base-root accordion-summary-root jss81" role="button" id="button-accordion-2" onclick="toggleAccordion(2)">
      <div class="accordion-summary-content jss82">
        <img class="jss75" src="{{ 'icon_quotation_mark.svg' | asset_url }}" alt="Ícone de uma lupa" />
        <div>
          <h3 class="jss41 jss46 jss54">Avaliações dos usuários</h3>
          <h4 class="jss40 jss49 jss54 jss73">Publicadas no Facebook</h4>
        </div>
      </div>
      <div class="button-base-root icon-button-root accordion-summary-expandIcon jss83 icon-button-edgeEnd" aria-disabled="false" aria-hidden="true">
        <span class="icon-button-label">
          <img class="jss74" src="{{ 'icon_plus_sign-gray.svg' | asset_url }}" />
        </span>
      </div>
    </div>

    <div class="accordion-content collapse-hidden" id="accordion-2">
      <div class="collapse-wrapper">
        <div class="collapse-wrapperInner">
          <div role="region">
            <div class="accordion-details-root jss84">
              <div class="jss172">
                <div class="jss169">
                  <div class="jss170">
                    <img src="{{ 'star.svg' | asset_url }}" class="jss173">
                    <img src="{{ 'star.svg' | asset_url }}" class="jss173">
                    <img src="{{ 'star.svg' | asset_url }}" class="jss173">
                    <img src="{{ 'star.svg' | asset_url }}" class="jss173">
                    <img src="{{ 'star.svg' | asset_url }}" class="jss173">
                    <div class="jss171">
                      <div class="jss41 jss50 jss54">Nota 5,0 de 5,0</div>
                      <div class="jss40 jss50 jss54">Mais de 2,8 mil avaliações</div>
                    </div>
                  </div>
                </div>
                <div>
                  <div class="jss166" id="container-feedbacks"></div>
                  <div id="btn-more-feed" class="jss40 jss50 jss54 jss167" onClick="carregarFeedbacks()">
                    Carregar mais avaliações ›
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="Paper-root accordion-root jss79 Paper-elevation0">
    <div class="button-base-root accordion-summary-root jss81" role="button" id="button-accordion-3" onclick="toggleAccordion(3)">
      <div class="accordion-summary-content jss82">
        <img class="jss75" src="{{ 'icon_question_mark.svg' | asset_url }}" alt="Ícone de uma lupa" />
        <div>
          <h3 class="jss41 jss46 jss54">Perguntas frequentes</h3>
          <h4 class="jss40 jss49 jss54 jss73">Sua dúvida pode estar aqui</h4>
        </div>
      </div>
      <div class="button-base-root icon-button-root accordion-summary-expandIcon jss83 icon-button-edgeEnd" aria-disabled="false" aria-hidden="true">
        <span class="icon-button-label">
          <img class="jss74" src="{{ 'icon_plus_sign-gray.svg' |asset_url }}" />
        </span>
      </div>
    </div>

    <div class="accordion-content collapse-hidden" id="accordion-3">
      <div class="collapse-wrapper">
        <div class="collapse-wrapperInner">
          <div role="region">
            {% render 'details-product-feedbacks', product: product %}
          </div>
        </div>
      </div>
    </div>
  </section>
</section>

<script>
  const toggleAccordion = (id) => {
    const accordionContent = document.querySelector('#accordion-' + id);
    accordionContent.classList.toggle('collapse-hidden');

    const buttonExpande = document.querySelector('#button-accordion-' + id);
    const icon = buttonExpande.querySelector('img.jss74');

    if (accordionContent.classList.contains('collapse-hidden')) {
      icon.style.transform = 'rotateZ(0deg)';
    } else {
      icon.style.transform = 'rotateZ(45deg)';
    }
  };

  const peoples = [
    { nome: "Ana Silva", sexo: "female", local: "Porto Alegre, RS" },
    { nome: "Bruno Oliveira", sexo: "male", local: "São Paulo, SP" },
    { nome: "Carlos Souza", sexo: "male", local: "Rio de Janeiro, RJ" },
    { nome: "Daniela Lima", sexo: "female", local: "Belo Horizonte, MG" },
    { nome: "Eduardo Costa", sexo: "male", local: "Curitiba, PR" },
    { nome: "Fernanda Alves", sexo: "female", local: "Recife, PE" },
    { nome: "Gabriel Pereira", sexo: "male", local: "Fortaleza, CE" },
    { nome: "Helena Rodrigues", sexo: "female", local: "Salvador, BA" },
    { nome: "Igor Fernandes", sexo: "male", local: "Florianópolis, SC" },
    { nome: "Julia Martins", sexo: "female", local: "Manaus, AM" },
    { nome: "Kleber Santos", sexo: "male", local: "Goiânia, GO" },
    { nome: "Larissa Almeida", sexo: "female", local: "Belém, PA" },
    { nome: "Marcelo Ferreira", sexo: "male", local: "Vitória, ES" },
    { nome: "Nathalia Barbosa", sexo: "female", local: "Campo Grande, MS" },
    { nome: "Otavio Ribeiro", sexo: "male", local: "Maceió, AL" },
    { nome: "Paula Melo", sexo: "female", local: "Natal, RN" },
    { nome: "Quirino Gomes", sexo: "male", local: "Teresina, PI" },
    { nome: "Renata Dias", sexo: "female", local: "João Pessoa, PB" },
    { nome: "Sandro Batista", sexo: "male", local: "Aracaju, SE" },
    { nome: "Tatiane Carvalho", sexo: "female", local: "Cuiabá, MT" },
    { nome: "Ubirajara Araujo", sexo: "male", local: "Palmas, TO" },
    { nome: "Vanessa Pires", sexo: "female", local: "Rio Branco, AC" },
    { nome: "Walter Cunha", sexo: "male", local: "Macapá, AP" },
    { nome: "Ximena Matos", sexo: "female", local: "Porto Velho, RO" },
    { nome: "Yuri Figueiredo", sexo: "male", local: "Boa Vista, RR" },
    { nome: "Zilda Teixeira", sexo: "female", local: "São Luís, MA" },
    { nome: "Aline Moreira", sexo: "female", local: "Santos, SP" },
    { nome: "Bruna Nascimento", sexo: "female", local: "Uberlândia, MG" },
    { nome: "Caio Souza", sexo: "male", local: "Ribeirão Preto, SP" },
    { nome: "Débora Rocha", sexo: "female", local: "Londrina, PR" }
  ];

  const containerFeedbacks = document.querySelector("#container-feedbacks");
  const feedbacks = [];
  let indexFeedback = 0;
  let regexComentario = /comentário:\s*(.*?)\*\*/gs;
  let match;

  while (match = regexComentario.exec(`{{product.description}}`)) {
    feedbacks.push(match[1]);
  }

  function carregarFeedbacks() {
    const maxIndex = Math.min(indexFeedback + 4, feedbacks.length);
    for (let i = indexFeedback; i < maxIndex; i++) {
      const random = Math.floor(Math.random() * 7) + 1;
      const random2 = Math.floor(Math.random() * 60) + 1;
      containerFeedbacks.innerHTML += `
        <div class="jss178">
          <div class="jss175">
            <div class="jss176">
              <img 
                style="width: 40px; height: 40px"
                src="https://xsgames.co/randomusers/assets/avatars/${peoples[i + random].sexo}/${random2}.jpg" 
                alt="Foto de perfil ${peoples[random + i].nome}"
              >
            </div>
            <div class="jss177">
              <div class="jss41 jss50 jss54">${peoples[random + i].nome}</div>
              <div class="jss40 jss50 jss54 jss174">${peoples[random + i].local}</div>
            </div>
          </div>
          <p class="jss40 jss48 jss54">${feedbacks[i]}</p>
        </div>
      `;
    }

    indexFeedback = maxIndex;

    if (indexFeedback >= feedbacks.length) {
      document.getElementById('btn-more-feed').style.display = "none";
    }
  }

  carregarFeedbacks()
</script>